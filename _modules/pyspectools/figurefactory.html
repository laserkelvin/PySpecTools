<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>pyspectools.figurefactory &#8212; PySpecTools 4.4.0 documentation</title>
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="../../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../../_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../../_static/bootstrap-sphinx.js "></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html">
          PySpecTools</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq.html">PySpecTools FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples.html">Example Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../pyspectools.spectra.html"><cite>Spectra</cite> Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api.html">API Reference</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"></ul>
</li>
              
            
            
              
                
              
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <h1>Source code for pyspectools.figurefactory</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">warnings</span> <span class="kn">import</span> <span class="n">warn</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">nx</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib.offsetbox</span> <span class="kn">import</span> <span class="n">AnnotationBbox</span><span class="p">,</span> <span class="n">OffsetImage</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">colors</span> <span class="k">as</span> <span class="n">cl</span>
<span class="kn">from</span> <span class="nn">plotly</span> <span class="kn">import</span> <span class="n">graph_objs</span> <span class="k">as</span> <span class="n">go</span>
<span class="kn">from</span> <span class="nn">plotly.offline</span> <span class="kn">import</span> <span class="n">plot</span>
<span class="kn">from</span> <span class="nn">plotly</span> <span class="kn">import</span> <span class="n">tools</span>
<span class="kn">from</span> <span class="nn">bokeh.plotting</span> <span class="kn">import</span> <span class="n">figure</span>
<span class="kn">from</span> <span class="nn">bokeh.models</span> <span class="kn">import</span> <span class="n">ColumnDataSource</span>
<span class="kn">from</span> <span class="nn">bokeh.models.widgets</span> <span class="kn">import</span> <span class="n">DataTable</span><span class="p">,</span> <span class="n">TableColumn</span>
<span class="kn">from</span> <span class="nn">bokeh.embed</span> <span class="kn">import</span> <span class="n">file_html</span>
<span class="kn">from</span> <span class="nn">bokeh.resources</span> <span class="kn">import</span> <span class="n">CDN</span>
<span class="kn">from</span> <span class="nn">bokeh.io</span> <span class="kn">import</span> <span class="n">curdoc</span>
<span class="kn">from</span> <span class="nn">bokeh.themes</span> <span class="kn">import</span> <span class="n">Theme</span>

<span class="kn">from</span> <span class="nn">pyspectools</span> <span class="kn">import</span> <span class="n">routines</span>


<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Commonly used formatting options</span>

<span class="sd">    These are generally parts of Matplotlib that I commonly change,</span>
<span class="sd">    but always have to look up stack overflow to find out how to do...</span>
<span class="sd">&quot;&quot;&quot;</span>


<div class="viewcode-block" id="strip_spines"><a class="viewcode-back" href="../../pyspectools.html#pyspectools.figurefactory.strip_spines">[docs]</a><span class="k">def</span> <span class="nf">strip_spines</span><span class="p">(</span><span class="n">spines</span><span class="p">,</span> <span class="n">axis</span><span class="p">):</span>
    <span class="c1"># Function for removing the spines from an axis.</span>
    <span class="k">for</span> <span class="n">spine</span> <span class="ow">in</span> <span class="n">spines</span><span class="p">:</span>
        <span class="n">axis</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="n">spine</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span></div>


<div class="viewcode-block" id="no_scientific"><a class="viewcode-back" href="../../pyspectools.html#pyspectools.figurefactory.no_scientific">[docs]</a><span class="k">def</span> <span class="nf">no_scientific</span><span class="p">(</span><span class="n">axis</span><span class="p">):</span>
    <span class="c1"># Turns off scientific notation for the axes</span>
    <span class="n">axis</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">get_major_formatter</span><span class="p">()</span><span class="o">.</span><span class="n">set_useOffset</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">axis</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">get_major_formatter</span><span class="p">()</span><span class="o">.</span><span class="n">set_useOffset</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span></div>


<div class="viewcode-block" id="format_ticklabels"><a class="viewcode-back" href="../../pyspectools.html#pyspectools.figurefactory.format_ticklabels">[docs]</a><span class="k">def</span> <span class="nf">format_ticklabels</span><span class="p">(</span><span class="n">axis</span><span class="p">):</span>
    <span class="c1"># Adds commas to denote thousands - quite useful for</span>
    <span class="c1"># publications</span>
    <span class="n">axis</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span>
        <span class="n">matplotlib</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="nb">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s2">&quot;,&quot;</span><span class="p">))</span>
    <span class="p">)</span></div>


<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Specific figure types</span>

<span class="sd">    These include recipes/routines to generate commonly used</span>
<span class="sd">    figures, providing the data is provided in a digestable</span>
<span class="sd">    way for the scripts.</span>

<span class="sd">    These include:</span>
<span class="sd">        - Polyad diagrams</span>
<span class="sd">        - Generic energy diagrams</span>
<span class="sd">        - Adding images to a matplotlib figure</span>
<span class="sd">&quot;&quot;&quot;</span>


<div class="viewcode-block" id="make_pes"><a class="viewcode-back" href="../../pyspectools.html#pyspectools.figurefactory.make_pes">[docs]</a><span class="k">def</span> <span class="nf">make_pes</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">energies</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Function to create a smooth PES, where stationary </span>
<span class="sd">        points are connected.</span>
<span class="sd">        </span>
<span class="sd">        Basically makes a linearly spaced x array which</span>
<span class="sd">        pads x-axis density to create the horizontal line</span>
<span class="sd">        for the stationary points</span>
<span class="sd">        </span>
<span class="sd">        Optional arguments are how many x-points to </span>
<span class="sd">        pad with on either side.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">new_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
    <span class="n">new_energies</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">xvalue</span><span class="p">,</span> <span class="n">energy</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">energies</span><span class="p">):</span>
        <span class="n">new_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">new_x</span><span class="p">,</span>
            <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">xvalue</span> <span class="o">-</span> <span class="p">(</span><span class="n">width</span> <span class="o">*</span> <span class="mf">0.05</span><span class="p">),</span> <span class="n">xvalue</span> <span class="o">+</span> <span class="p">(</span><span class="n">width</span> <span class="o">*</span> <span class="mf">0.05</span><span class="p">),</span> <span class="n">width</span> <span class="o">*</span> <span class="mi">2</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="n">new_energies</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">energy</span><span class="p">]</span> <span class="o">*</span> <span class="n">width</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">new_x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">new_energies</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span></div>


<div class="viewcode-block" id="calc_vibE"><a class="viewcode-back" href="../../pyspectools.html#pyspectools.figurefactory.calc_vibE">[docs]</a><span class="k">def</span> <span class="nf">calc_vibE</span><span class="p">(</span><span class="n">quant_nums</span><span class="p">,</span> <span class="n">vibrations</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function that will calculate a 1D array of</span>
<span class="sd">        vibrational energies, based on a nested list</span>
<span class="sd">        of quantum numbers and a list of vibrational</span>
<span class="sd">        frequencies.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">energies</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="n">quant_nums</span><span class="p">:</span>
        <span class="n">energies</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;state&quot;</span><span class="p">:</span> <span class="n">state</span><span class="p">,</span> <span class="s2">&quot;energy&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">state</span> <span class="o">*</span> <span class="n">vibrations</span><span class="p">)})</span>
    <span class="k">return</span> <span class="n">energies</span></div>


<div class="viewcode-block" id="generate_x_coord"><a class="viewcode-back" href="../../pyspectools.html#pyspectools.figurefactory.generate_x_coord">[docs]</a><span class="k">def</span> <span class="nf">generate_x_coord</span><span class="p">(</span><span class="n">quant_nums</span><span class="p">,</span> <span class="n">energies</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function to generate the x coordinate for plotting</span>
<span class="sd">        based on the quantum numbers specified.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Get boolean mask, and find the unique combinations</span>
    <span class="n">unique_combos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">quant_nums</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">n_unique</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_combos</span><span class="p">)</span>
    <span class="n">cat_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">x</span><span class="p">:</span> <span class="nb">list</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_unique</span><span class="p">)}</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">energies</span><span class="p">:</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">unique_combos</span> <span class="o">==</span> <span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">cat_dict</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">cat_dict</span></div>


<div class="viewcode-block" id="make_elevel_plot"><a class="viewcode-back" href="../../pyspectools.html#pyspectools.figurefactory.make_elevel_plot">[docs]</a><span class="k">def</span> <span class="nf">make_elevel_plot</span><span class="p">(</span><span class="n">cat_dict</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">maxE</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        make_elevel_plot is used to create energy level diagrams</span>
<span class="sd">        with Matplotlib axis objects. This is considered slightly</span>
<span class="sd">        lower level: you should call the higher level wrapper functions</span>
<span class="sd">        like vib_energy_diagram instead!</span>

<span class="sd">        The function will loop over every transition that has</span>
<span class="sd">        been categorized/binned into an x-axis index, and sub-</span>
<span class="sd">        sequently plot each x-bin individually.</span>

<span class="sd">        The input arguments are:</span>

<span class="sd">        cat_dict: dict-like with keys as the x-axis values, and</span>
<span class="sd">        the items are dictionaries containing the energy and</span>
<span class="sd">        quantum number configuration.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Spacing defines the x-axis unit spacing</span>
    <span class="n">spacing</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="c1"># Defines the width of the levels</span>
    <span class="n">width</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="c1"># Loop over every state</span>
    <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">cat_dict</span><span class="p">:</span>
        <span class="n">xs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="n">ys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="n">annotations</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">cat_dict</span><span class="p">[</span><span class="n">index</span><span class="p">]:</span>
            <span class="n">xs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
            <span class="n">ys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;energy&quot;</span><span class="p">])</span>
            <span class="n">annotations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span>
        <span class="n">axis</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span>
            <span class="n">ys</span><span class="p">,</span>
            <span class="p">[</span><span class="n">x</span> <span class="o">-</span> <span class="p">(</span><span class="n">width</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">)</span> <span class="o">+</span> <span class="n">spacing</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">xs</span><span class="p">],</span>
            <span class="p">[</span><span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="n">width</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">)</span> <span class="o">+</span> <span class="n">spacing</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">xs</span><span class="p">],</span>
            <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="c1"># Loop over configurations and annotate the energy levels</span>
        <span class="c1"># with their quantum numbers</span>
        <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">text</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">annotations</span><span class="p">):</span>
            <span class="c1"># Providing the value is less than the maximum specified</span>
            <span class="c1"># energy, add the annotation</span>
            <span class="k">if</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="n">maxE</span><span class="p">:</span>
                <span class="n">axis</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
                    <span class="n">x</span> <span class="o">+</span> <span class="n">spacing</span><span class="p">,</span>
                    <span class="n">y</span> <span class="o">+</span> <span class="mf">30.0</span><span class="p">,</span>
                    <span class="n">text</span><span class="p">,</span>
                    <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
                    <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
                    <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
                    <span class="n">size</span><span class="o">=</span><span class="mf">8.0</span><span class="p">,</span>
                <span class="p">)</span></div>


<div class="viewcode-block" id="add_image"><a class="viewcode-back" href="../../pyspectools.html#pyspectools.figurefactory.add_image">[docs]</a><span class="k">def</span> <span class="nf">add_image</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">filepath</span><span class="p">,</span> <span class="n">zoom</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function to add an image annotation to a specified axis.</span>

<span class="sd">        Takes the matplotlib axis and filepath to the image as input,</span>
<span class="sd">        and optional arguments for the scaling (zoom) and position of</span>
<span class="sd">        the image in axis units.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">image</span> <span class="o">=</span> <span class="n">OffsetImage</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;png&quot;</span><span class="p">),</span> <span class="n">zoom</span><span class="o">=</span><span class="n">zoom</span><span class="p">)</span>
    <span class="n">image</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">axes</span> <span class="o">=</span> <span class="n">axis</span>

    <span class="n">box</span> <span class="o">=</span> <span class="n">AnnotationBbox</span><span class="p">(</span>
        <span class="n">image</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">xybox</span><span class="o">=</span><span class="n">position</span><span class="p">,</span> <span class="n">xycoords</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="n">axis</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">box</span><span class="p">)</span></div>


<div class="viewcode-block" id="vib_energy_diagram"><a class="viewcode-back" href="../../pyspectools.html#pyspectools.figurefactory.vib_energy_diagram">[docs]</a><span class="k">def</span> <span class="nf">vib_energy_diagram</span><span class="p">(</span>
    <span class="n">quant_nums</span><span class="p">,</span> <span class="n">vibrations</span><span class="p">,</span> <span class="n">maxV</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">maxE</span><span class="o">=</span><span class="mf">3000.0</span><span class="p">,</span> <span class="n">useFull</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">imagesize</span><span class="o">=</span><span class="mf">0.1</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function that will generate a vibrational energy diagram.</span>

<span class="sd">        This function wraps the make_elevel_plot function!</span>

<span class="sd">        Input arguments are</span>

<span class="sd">        quant_nums: A 2D numpy array of quantum numbers, where each row is</span>
<span class="sd">        a single configuration.</span>
<span class="sd">        vibrations: A list of vibrational frequencies.</span>
<span class="sd">        maxV: The maximum quanta for considering predicted frequencies.</span>
<span class="sd">        maxE: Maximum energy for plotting.</span>
<span class="sd">        useFull: Boolean for flagging whether predict frequencies are plotted.</span>
<span class="sd">        image: String-like for specifying path to an image.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Generate a list of possible quanta from 0 to maxV</span>
    <span class="n">full_quant</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">maxV</span><span class="p">)</span>
    <span class="c1"># Create a generator that will provide every possible configuration</span>
    <span class="c1"># of quantum numbers</span>
    <span class="n">full_combo</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">product</span><span class="p">(</span><span class="n">full_quant</span><span class="p">,</span> <span class="n">repeat</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">vibrations</span><span class="p">))))</span>
    <span class="c1"># Calculate the energies of all possible configurations</span>
    <span class="n">full_energies</span> <span class="o">=</span> <span class="n">calc_vibE</span><span class="p">(</span><span class="n">full_combo</span><span class="p">,</span> <span class="n">vibrations</span><span class="p">)</span>
    <span class="n">full_cat_dict</span> <span class="o">=</span> <span class="n">generate_x_coord</span><span class="p">(</span><span class="n">full_combo</span><span class="p">,</span> <span class="n">full_energies</span><span class="p">)</span>
    <span class="n">energies</span> <span class="o">=</span> <span class="n">calc_vibE</span><span class="p">(</span><span class="n">quant_nums</span><span class="p">,</span> <span class="n">vibrations</span><span class="p">)</span>
    <span class="c1"># useFull denotes whether or not to use the predicted combination</span>
    <span class="c1"># energies. If False, we only display the vibrations observed</span>
    <span class="k">if</span> <span class="n">useFull</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">cat_dict</span> <span class="o">=</span> <span class="n">generate_x_coord</span><span class="p">(</span><span class="n">full_combo</span><span class="p">,</span> <span class="n">energies</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">cat_dict</span> <span class="o">=</span> <span class="n">generate_x_coord</span><span class="p">(</span><span class="n">quant_nums</span><span class="p">,</span> <span class="n">energies</span><span class="p">)</span>

    <span class="c1"># Initialize the figure object</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">))</span>
    <span class="c1"># If we want to show predictions, plot them up too</span>
    <span class="k">if</span> <span class="n">useFull</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">make_plot</span><span class="p">(</span><span class="n">full_cat_dict</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">maxE</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">)</span>
    <span class="c1"># Call function to plot up diagram</span>
    <span class="n">make_plot</span><span class="p">(</span><span class="n">cat_dict</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="s2">&quot;#e41a1c&quot;</span><span class="p">,</span> <span class="n">maxE</span><span class="p">)</span>

    <span class="c1"># Set various labelling</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Vibrational state&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Energy (cm$^{-1}$)&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">50.0</span><span class="p">,</span> <span class="n">maxE</span><span class="p">])</span>

    <span class="n">minx</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">maxx</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1"># Annotate the fundamentals</span>
    <span class="k">for</span> <span class="n">vibration</span> <span class="ow">in</span> <span class="n">vibrations</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span>
            <span class="n">vibration</span><span class="p">,</span>
            <span class="n">minx</span><span class="p">,</span>
            <span class="n">maxx</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#377eb8&quot;</span><span class="p">,</span>
            <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span>
            <span class="n">zorder</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="c1"># If an image filepath is specified, then plot it up on the edge</span>
        <span class="k">if</span> <span class="n">image</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">add_image</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="n">zoom</span><span class="o">=</span><span class="n">imagesize</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="p">[</span><span class="n">maxx</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">vibration</span><span class="p">])</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span></div>


<div class="viewcode-block" id="overlay_dr_spectrum"><a class="viewcode-back" href="../../pyspectools.html#pyspectools.figurefactory.overlay_dr_spectrum">[docs]</a><span class="k">def</span> <span class="nf">overlay_dr_spectrum</span><span class="p">(</span>
    <span class="n">dataframe</span><span class="p">,</span> <span class="n">progressions</span><span class="p">,</span> <span class="n">freq_col</span><span class="o">=</span><span class="s2">&quot;Frequency&quot;</span><span class="p">,</span> <span class="n">int_col</span><span class="o">=</span><span class="s2">&quot;Intensity&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
<span class="p">):</span>
    <span class="n">layout</span> <span class="o">=</span> <span class="n">define_layout</span><span class="p">(</span><span class="s2">&quot;Frequency (MHz)&quot;</span><span class="p">,</span> <span class="s2">&quot;Intensity&quot;</span><span class="p">)</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">FigureWidget</span><span class="p">(</span><span class="n">layout</span><span class="o">=</span><span class="n">layout</span><span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">add_scattergl</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">dataframe</span><span class="p">[</span><span class="n">freq_col</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">dataframe</span><span class="p">[</span><span class="n">int_col</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Observation&quot;</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.4</span>
    <span class="p">)</span>

    <span class="n">colors</span> <span class="o">=</span> <span class="n">generate_colors</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">progressions</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">tab10</span><span class="p">)</span>
    <span class="n">level</span> <span class="o">=</span> <span class="mf">2.0</span>

    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="p">(</span><span class="n">progression</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">progressions</span><span class="p">,</span> <span class="n">colors</span><span class="p">)):</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">progression</span> <span class="o">&lt;=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">dataframe</span><span class="p">[</span><span class="n">freq_col</span><span class="p">]))</span>
        <span class="n">progression</span> <span class="o">=</span> <span class="n">progression</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
        <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[</span><span class="n">routines</span><span class="o">.</span><span class="n">find_nearest</span><span class="p">(</span><span class="n">dataframe</span><span class="p">[</span><span class="n">freq_col</span><span class="p">],</span> <span class="n">freq</span><span class="p">)</span> <span class="k">for</span> <span class="n">freq</span> <span class="ow">in</span> <span class="n">progression</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="n">indices</span> <span class="o">=</span> <span class="n">indices</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">dataframe</span><span class="p">[</span><span class="n">int_col</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">indices</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1.2</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">add_scattergl</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">progression</span><span class="p">,</span>
            <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
            <span class="n">marker</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="n">color</span><span class="p">},</span>
            <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;markers+lines&quot;</span><span class="p">,</span>
            <span class="n">hoverinfo</span><span class="o">=</span><span class="s2">&quot;name+x&quot;</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Progression </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">index</span><span class="p">),</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">fig</span></div>


<div class="viewcode-block" id="dr_network_diagram"><a class="viewcode-back" href="../../pyspectools.html#pyspectools.figurefactory.dr_network_diagram">[docs]</a><span class="k">def</span> <span class="nf">dr_network_diagram</span><span class="p">(</span><span class="n">connections</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Use NetworkX to create a graph with nodes corresponding to cavity</span>
<span class="sd">    frequencies, and vertices as DR connections.</span>
<span class="sd">    The color map can be specified by passing kwargs.</span>
<span class="sd">    :param connections: list of 2-tuples corresponding to pairs of connections</span>
<span class="sd">    :return</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">graph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">()</span>
    <span class="n">nodes</span> <span class="o">=</span> <span class="p">[</span><span class="n">graph</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">frequency</span><span class="p">)</span> <span class="k">for</span> <span class="n">frequency</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">connections</span><span class="p">)]</span>
    <span class="n">vertices</span> <span class="o">=</span> <span class="p">[</span><span class="n">graph</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="o">*</span><span class="n">pair</span><span class="p">)</span> <span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="n">connections</span><span class="p">]</span>
    <span class="c1"># Generate positions based on the shell layout that&#39;s typical of DR connections</span>
    <span class="c1"># Frequencies are sorted in anti-clockwise order, starting at 3 o&#39;clock</span>
    <span class="n">positions</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">shell_layout</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>

    <span class="n">color_kwarg</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cmap&quot;</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">tab10</span><span class="p">}</span>
    <span class="k">if</span> <span class="s2">&quot;cmap&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">color_kwarg</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="n">coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">positions</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
    <span class="n">connected</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">connected_components</span><span class="p">(</span><span class="n">graph</span><span class="p">))</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="n">generate_colors</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">connected</span><span class="p">),</span> <span class="o">**</span><span class="n">color_kwarg</span><span class="p">)</span>

    <span class="n">fig_layout</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;height&quot;</span><span class="p">:</span> <span class="mf">700.0</span><span class="p">,</span>
        <span class="s2">&quot;width&quot;</span><span class="p">:</span> <span class="mf">700.0</span><span class="p">,</span>
        <span class="s2">&quot;autosize&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;xaxis&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;showgrid&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
            <span class="s2">&quot;zeroline&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
            <span class="s2">&quot;ticks&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="s2">&quot;showticklabels&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;yaxis&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;showgrid&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
            <span class="s2">&quot;zeroline&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
            <span class="s2">&quot;ticks&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="s2">&quot;showticklabels&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;showlegend&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">FigureWidget</span><span class="p">(</span><span class="n">layout</span><span class="o">=</span><span class="n">fig_layout</span><span class="p">)</span>
    <span class="c1"># Draw the nodes</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">add_scattergl</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">coords</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="n">y</span><span class="o">=</span><span class="n">coords</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>
        <span class="n">text</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">connections</span><span class="p">)),</span>
        <span class="n">hoverinfo</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
        <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;markers&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="c1"># Draw the vertices</span>
    <span class="k">for</span> <span class="n">connectivity</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">connected</span><span class="p">,</span> <span class="n">colors</span><span class="p">):</span>
        <span class="c1"># Get all of the coordinates associated with edges within a series</span>
        <span class="c1"># of connections</span>
        <span class="n">coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">positions</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">connectivity</span><span class="p">)])</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">add_scattergl</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">coords</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="n">y</span><span class="o">=</span><span class="n">coords</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>
            <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
            <span class="n">hoverinfo</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="n">opacity</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span>
            <span class="n">marker</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="n">color</span><span class="p">},</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">connected</span></div>


<div class="viewcode-block" id="init_plotly_subplot"><a class="viewcode-back" href="../../pyspectools.html#pyspectools.figurefactory.init_plotly_subplot">[docs]</a><span class="k">def</span> <span class="nf">init_plotly_subplot</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize a Plotly subplot.</span>
<span class="sd">    :param nrows: number of rows for the subplot</span>
<span class="sd">    :param ncols: number of columns for the subplot</span>
<span class="sd">    :return: plotly FigureWidget object</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">subplot</span> <span class="o">=</span> <span class="n">tools</span><span class="o">.</span><span class="n">make_subplots</span><span class="p">(</span><span class="n">rows</span><span class="o">=</span><span class="n">nrows</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="n">ncols</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">FigureWidget</span><span class="p">(</span><span class="n">subplot</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fig</span></div>


<div class="viewcode-block" id="stacked_plot"><a class="viewcode-back" href="../../pyspectools.html#pyspectools.figurefactory.stacked_plot">[docs]</a><span class="k">def</span> <span class="nf">stacked_plot</span><span class="p">(</span>
    <span class="n">dataframe</span><span class="p">,</span> <span class="n">frequencies</span><span class="p">,</span> <span class="n">freq_range</span><span class="o">=</span><span class="mf">0.002</span><span class="p">,</span> <span class="n">freq_col</span><span class="o">=</span><span class="s2">&quot;Frequency&quot;</span><span class="p">,</span> <span class="n">int_col</span><span class="o">=</span><span class="s2">&quot;Intensity&quot;</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a Loomis-Wood style plot via a list of frequencies, and a broadband</span>
<span class="sd">    spectrum. The keyword freq_range will use a percentage of the center</span>
<span class="sd">    frequency to extend the frequency range that gets plotted.</span>
<span class="sd">    :param dataframe: pandas DataFrame</span>
<span class="sd">    :param frequencies: iterable with float frequencies to use as centers</span>
<span class="sd">    :param freq_range: decimal percentage to specify the range to plot</span>
<span class="sd">    :param freq_col: str name for the column to use as the frequency axis</span>
<span class="sd">    :param int_col: str name for the column to use as the intensity axis</span>
<span class="sd">    :return fig: Plotly FigureWidget with the subplots</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">plot_func</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Scattergl</span>

    <span class="c1"># Want the frequencies in ascending order, going upwards in the plot</span>
    <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
        <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span>
            <span class="n">dataframe</span><span class="p">[</span><span class="n">freq_col</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="n">frequencies</span><span class="p">,</span>
            <span class="n">frequencies</span> <span class="o">&lt;=</span> <span class="n">dataframe</span><span class="p">[</span><span class="n">freq_col</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="c1"># Plot only frequencies within band</span>
    <span class="n">frequencies</span> <span class="o">=</span> <span class="n">frequencies</span><span class="p">[</span><span class="n">indices</span><span class="p">]</span>
    <span class="n">frequencies</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">frequencies</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">nplots</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">frequencies</span><span class="p">)</span>

    <span class="n">titles</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:.0f}</span><span class="s2"> MHz&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">frequency</span><span class="p">)</span> <span class="k">for</span> <span class="n">frequency</span> <span class="ow">in</span> <span class="n">frequencies</span><span class="p">)</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">init_plotly_subplot</span><span class="p">(</span>
        <span class="n">nrows</span><span class="o">=</span><span class="n">nplots</span><span class="p">,</span>
        <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="o">**</span><span class="p">{</span><span class="s2">&quot;subplot_titles&quot;</span><span class="p">:</span> <span class="n">titles</span><span class="p">,</span> <span class="s2">&quot;vertical_spacing&quot;</span><span class="p">:</span> <span class="mf">0.15</span><span class="p">,</span> <span class="s2">&quot;shared_xaxes&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
    <span class="p">)</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">frequency</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">frequencies</span><span class="p">):</span>
        <span class="c1"># Calculate the offset frequency</span>
        <span class="n">dataframe</span><span class="p">[</span><span class="s2">&quot;Offset &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">index</span><span class="p">)]</span> <span class="o">=</span> <span class="n">dataframe</span><span class="p">[</span><span class="n">freq_col</span><span class="p">]</span> <span class="o">-</span> <span class="n">frequency</span>
        <span class="c1"># Range as a fraction of the center frequency</span>
        <span class="n">freq_cutoff</span> <span class="o">=</span> <span class="n">freq_range</span> <span class="o">*</span> <span class="n">frequency</span>
        <span class="n">sliced_df</span> <span class="o">=</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
            <span class="p">(</span><span class="n">dataframe</span><span class="p">[</span><span class="s2">&quot;Offset &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">index</span><span class="p">)]</span> <span class="o">&gt;</span> <span class="o">-</span><span class="n">freq_cutoff</span><span class="p">)</span>
            <span class="o">&amp;</span> <span class="p">(</span><span class="n">dataframe</span><span class="p">[</span><span class="s2">&quot;Offset &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">index</span><span class="p">)]</span> <span class="o">&lt;</span> <span class="n">freq_cutoff</span><span class="p">)</span>
        <span class="p">]</span>
        <span class="c1"># Plot the data</span>
        <span class="n">trace</span> <span class="o">=</span> <span class="n">plot_func</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">sliced_df</span><span class="p">[</span><span class="s2">&quot;Offset &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">index</span><span class="p">)],</span> <span class="n">y</span><span class="o">=</span><span class="n">sliced_df</span><span class="p">[</span><span class="n">int_col</span><span class="p">],</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span>
        <span class="p">)</span>
        <span class="c1"># Plotly indexes from one because they&#39;re stupid</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">trace</span><span class="p">,</span> <span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">fig</span><span class="p">[</span><span class="s2">&quot;layout&quot;</span><span class="p">][</span><span class="s2">&quot;xaxis1&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
            <span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="n">freq_cutoff</span><span class="p">,</span> <span class="n">freq_cutoff</span><span class="p">],</span>
            <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Offset frequency (MHz)&quot;</span><span class="p">,</span>
            <span class="n">showgrid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">fig</span><span class="p">[</span><span class="s2">&quot;layout&quot;</span><span class="p">][</span><span class="s2">&quot;yaxis&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">showgrid</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">fig</span><span class="p">[</span><span class="s2">&quot;layout&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">autosize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">900</span><span class="p">,</span> <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fig</span></div>


<div class="viewcode-block" id="plot_catchirp"><a class="viewcode-back" href="../../pyspectools.html#pyspectools.figurefactory.plot_catchirp">[docs]</a><span class="k">def</span> <span class="nf">plot_catchirp</span><span class="p">(</span><span class="n">chirpdf</span><span class="p">,</span> <span class="n">catfiles</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Function to perform interactive analysis with a chirp spectrum, as well</span>
<span class="sd">        as any reference .cat files you may want to provide.</span>
<span class="sd">        This is not designed to replace SPECData analysis, but simply to</span>
<span class="sd">        perform some interactive viewing of the data.</span>

<span class="sd">        The argument `catfiles` is supplied as a dictionary; where the keys are</span>
<span class="sd">        the names of the species, and the items are the paths to the .cat files</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Generate the experimental plot first</span>
    <span class="n">plots</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="n">exp_trace</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Scattergl</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">chirpdf</span><span class="p">[</span><span class="s2">&quot;Frequency&quot;</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">chirpdf</span><span class="p">[</span><span class="s2">&quot;Intensity&quot;</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Experiment&quot;</span>
    <span class="p">)</span>

    <span class="n">plots</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">exp_trace</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">catfiles</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Generate the color palette, and remove the alpha value from RGBA</span>
        <span class="n">color_palette</span> <span class="o">=</span> <span class="n">generate_colors</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">catfiles</span><span class="p">))</span>
        <span class="c1"># Loop over each of the cat files</span>
        <span class="k">for</span> <span class="n">color</span><span class="p">,</span> <span class="n">species</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">color_palette</span><span class="p">,</span> <span class="n">catfiles</span><span class="p">):</span>
            <span class="n">species_df</span> <span class="o">=</span> <span class="n">pc</span><span class="o">.</span><span class="n">pick_pickett</span><span class="p">(</span><span class="n">catfiles</span><span class="p">[</span><span class="n">species</span><span class="p">])</span>
            <span class="n">plots</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">go</span><span class="o">.</span><span class="n">Bar</span><span class="p">(</span>
                    <span class="n">x</span><span class="o">=</span><span class="n">species_df</span><span class="p">[</span><span class="s2">&quot;Frequency&quot;</span><span class="p">],</span>
                    <span class="n">y</span><span class="o">=</span><span class="n">species_df</span><span class="p">[</span><span class="s2">&quot;Intensity&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">species_df</span><span class="p">[</span><span class="s2">&quot;Intensity&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
                    <span class="n">name</span><span class="o">=</span><span class="n">species</span><span class="p">,</span>
                    <span class="n">marker</span><span class="o">=</span><span class="p">{</span>
                        <span class="c1"># Convert the matplotlib rgb color to hex code</span>
                        <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="n">color</span>
                    <span class="p">},</span>
                    <span class="n">width</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
                    <span class="n">opacity</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span>
                    <span class="n">yaxis</span><span class="o">=</span><span class="s2">&quot;y2&quot;</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>
    <span class="n">layout</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span>
        <span class="n">autosize</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">height</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span>
        <span class="n">width</span><span class="o">=</span><span class="mi">900</span><span class="p">,</span>
        <span class="n">xaxis</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;Frequency (MHz)&quot;</span><span class="p">},</span>
        <span class="n">paper_bgcolor</span><span class="o">=</span><span class="s2">&quot;#f0f0f0&quot;</span><span class="p">,</span>
        <span class="n">plot_bgcolor</span><span class="o">=</span><span class="s2">&quot;#f0f0f0&quot;</span><span class="p">,</span>
        <span class="n">yaxis</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">},</span>
        <span class="n">yaxis2</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;side&quot;</span><span class="p">:</span> <span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="s2">&quot;overlaying&quot;</span><span class="p">:</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;range&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]},</span>
    <span class="p">)</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">FigureWidget</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">plots</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="n">layout</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span></div>


<div class="viewcode-block" id="plot_df"><a class="viewcode-back" href="../../pyspectools.html#pyspectools.figurefactory.plot_df">[docs]</a><span class="k">def</span> <span class="nf">plot_df</span><span class="p">(</span><span class="n">dataframe</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Function that wraps around the lower level function plot_column.</span>
<span class="sd">        Will plot every column in a dataframe against the Frequency, unless</span>
<span class="sd">        specific column names are provided.</span>

<span class="sd">        Input arguments:</span>
<span class="sd">        dataframe - pandas dataframe object, with every column as intensity</span>
<span class="sd">        except &quot;Frequency&quot;</span>
<span class="sd">        cols - NoneType or tuple-like: if None, every column is plotted.</span>
<span class="sd">        Alternatively, an iterable is provided to specify which columns are</span>
<span class="sd">        plotted.</span>
<span class="sd">        Optional arguments are passed into define_layout, which will define</span>
<span class="sd">        the axis labels, or into the color map generation</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">cols</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">key</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span> <span class="o">!=</span> <span class="s2">&quot;Frequency&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">:</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;#66c2a5&quot;</span><span class="p">,</span> <span class="s2">&quot;#fc8d62&quot;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="n">generate_colors</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cols</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="c1"># Generate the plotly traces</span>
    <span class="n">traces</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">plot_column</span><span class="p">(</span><span class="n">dataframe</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span> <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">cols</span><span class="p">,</span> <span class="n">colors</span><span class="p">)</span>
    <span class="p">]</span>
    <span class="n">layout</span> <span class="o">=</span> <span class="n">define_layout</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="c1"># Generate figure object</span>
    <span class="n">figure</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">traces</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="n">layout</span><span class="p">)</span>
    <span class="n">iplot</span><span class="p">(</span><span class="n">figure</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">figure</span></div>


<div class="viewcode-block" id="plot_assignment"><a class="viewcode-back" href="../../pyspectools.html#pyspectools.figurefactory.plot_assignment">[docs]</a><span class="k">def</span> <span class="nf">plot_assignment</span><span class="p">(</span><span class="n">spec_df</span><span class="p">,</span> <span class="n">assignments_df</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;Intensity&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Function for plotting spectra with assignments. The assumption is that</span>
<span class="sd">        the assignments routines are ran prior too this, and so the function</span>
<span class="sd">        simply takes a dataframe of chosen molecules and plots them alongside</span>
<span class="sd">        the experimental spectrum, color coded by the molecule</span>

<span class="sd">        Input argument:</span>
<span class="sd">        spec_df - dataframe holding the experimental data</span>
<span class="sd">        assignments_df - dataframe produced from running assignments</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Get a list of unique molecules</span>
    <span class="n">molecules</span> <span class="o">=</span> <span class="n">assignments_df</span><span class="p">[</span><span class="s2">&quot;Chemical Name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
    <span class="c1"># The ttal number of traces are the number of unique molecules, the traces</span>
    <span class="c1"># in the experimental data minus the frequency column</span>
    <span class="n">nitems</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">molecules</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="n">color_iterator</span><span class="p">(</span><span class="n">nitems</span><span class="p">)</span>
    <span class="n">traces</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="c1"># Loop over the experimental data</span>
    <span class="n">traces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">plot_column</span><span class="p">(</span><span class="n">spec_df</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="nb">next</span><span class="p">(</span><span class="n">colors</span><span class="p">)))</span>
    <span class="c1"># Loop over the assignments</span>
    <span class="k">for</span> <span class="n">molecule</span> <span class="ow">in</span> <span class="n">molecules</span><span class="p">:</span>
        <span class="n">sliced_df</span> <span class="o">=</span> <span class="n">assignments_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">assignments_df</span><span class="p">[</span><span class="s2">&quot;Chemical Name&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">molecule</span><span class="p">]</span>
        <span class="n">traces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">plot_bar_assignments</span><span class="p">(</span><span class="n">sliced_df</span><span class="p">,</span> <span class="nb">next</span><span class="p">(</span><span class="n">colors</span><span class="p">)))</span>
    <span class="n">layout</span> <span class="o">=</span> <span class="n">define_layout</span><span class="p">()</span>
    <span class="n">layout</span><span class="p">[</span><span class="s2">&quot;yaxis&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;Experimental Intensity&quot;</span><span class="p">}</span>
    <span class="c1"># Specify a second y axis for the catalog intensity</span>
    <span class="n">layout</span><span class="p">[</span><span class="s2">&quot;yaxis2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;CDMS/JPL Intensity&quot;</span><span class="p">,</span>
        <span class="s2">&quot;overlaying&quot;</span><span class="p">:</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span>
        <span class="s2">&quot;side&quot;</span><span class="p">:</span> <span class="s2">&quot;right&quot;</span><span class="p">,</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;log&quot;</span><span class="p">,</span>
        <span class="s2">&quot;autorange&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">figure</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">traces</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="n">layout</span><span class="p">)</span>
    <span class="n">plot</span><span class="p">(</span><span class="n">figure</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">figure</span></div>


<div class="viewcode-block" id="generate_colors"><a class="viewcode-back" href="../../pyspectools.html#pyspectools.figurefactory.generate_colors">[docs]</a><span class="k">def</span> <span class="nf">generate_colors</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">Spectral</span><span class="p">,</span> <span class="nb">hex</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate a linearly spaced color series using a colormap from</span>
<span class="sd">    Matplotlib. The colors can be returned as either RGB values</span>
<span class="sd">    or as hex-codes using the `hex` flag.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    n : int</span>
<span class="sd">        Number of colours to generate</span>
<span class="sd">    cmap : str or `matplotlib.colors.LinearSegementedColomap`, optional</span>
<span class="sd">        Specified colormap to interpolate. If a str is provided, the function</span>
<span class="sd">        will try to look for it in the available matplotlib colormaps.</span>
<span class="sd">    hex : bool, optional</span>
<span class="sd">        If True, hex colors are returned. Otherwise, RGB values.</span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    colors</span>
<span class="sd">        List of hex or RGB codes</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># In the case that a string is passed, use the `get_cmap` function instead</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">cmap</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">cmap</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="n">warn</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">cmap</span><span class="si">}</span><span class="s2"> not found in Matplotlib, defaulting to Spectral.&quot;</span><span class="p">)</span>
            <span class="k">pass</span>
    <span class="n">colormap</span> <span class="o">=</span> <span class="n">cmap</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
    <span class="k">if</span> <span class="nb">hex</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">cl</span><span class="o">.</span><span class="n">rgb2hex</span><span class="p">(</span><span class="n">color</span><span class="p">)</span> <span class="k">for</span> <span class="n">color</span> <span class="ow">in</span> <span class="n">colormap</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="n">colormap</span>
    <span class="k">return</span> <span class="n">colors</span></div>


<div class="viewcode-block" id="color_iterator"><a class="viewcode-back" href="../../pyspectools.html#pyspectools.figurefactory.color_iterator">[docs]</a><span class="k">def</span> <span class="nf">color_iterator</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Simple generator that will yield a different color each time.</span>
<span class="sd">        This is primarily designed when multiple plot types are expected.</span>

<span class="sd">        Input arguements:</span>
<span class="sd">        n - number of plots</span>
<span class="sd">        Optional kwargs are passed into generate_colors</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="n">generate_colors</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">while</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">:</span>
        <span class="k">yield</span> <span class="n">colors</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
        <span class="n">index</span> <span class="o">+=</span> <span class="mi">1</span></div>


<div class="viewcode-block" id="plot_bar_assignments"><a class="viewcode-back" href="../../pyspectools.html#pyspectools.figurefactory.plot_bar_assignments">[docs]</a><span class="k">def</span> <span class="nf">plot_bar_assignments</span><span class="p">(</span><span class="n">species_df</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#fc8d62&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Function to generate a bar plot trace for a chemical species.</span>
<span class="sd">        These plots will be placed in the second y axis!</span>

<span class="sd">        Input arguments:</span>
<span class="sd">        species_df - a slice of an assignments dataframe, containing only</span>
<span class="sd">        one unique species</span>
<span class="sd">        Optional argument color is a hex code color; if nothing is given</span>
<span class="sd">        it just defaults to whatever</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># We just want one of the molecules, not their life&#39;s story</span>
    <span class="n">molecule</span> <span class="o">=</span> <span class="n">species_df</span><span class="p">[</span><span class="s2">&quot;Chemical Name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">trace</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Bar</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">species_df</span><span class="p">[</span><span class="s2">&quot;Combined&quot;</span><span class="p">],</span>
        <span class="n">y</span><span class="o">=</span><span class="mi">10</span> <span class="o">**</span> <span class="n">species_df</span><span class="p">[</span><span class="s2">&quot;CDMS/JPL Intensity&quot;</span><span class="p">],</span>
        <span class="n">name</span><span class="o">=</span><span class="n">molecule</span><span class="p">,</span>
        <span class="n">text</span><span class="o">=</span><span class="n">species_df</span><span class="p">[</span><span class="s2">&quot;Resolved QNs&quot;</span><span class="p">],</span>
        <span class="n">marker</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="n">color</span><span class="p">},</span>
        <span class="n">width</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
        <span class="n">yaxis</span><span class="o">=</span><span class="s2">&quot;y2&quot;</span><span class="p">,</span>
        <span class="n">opacity</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">trace</span></div>


<div class="viewcode-block" id="plot_column"><a class="viewcode-back" href="../../pyspectools.html#pyspectools.figurefactory.plot_column">[docs]</a><span class="k">def</span> <span class="nf">plot_column</span><span class="p">(</span><span class="n">dataframe</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; A low level function for plotting a specific column of</span>
<span class="sd">        data in a pandas dataframe. This will assume that there</span>
<span class="sd">        is a column named &quot;Frequency&quot; in the dataframe.</span>

<span class="sd">        If a layout is not supplied, then the function will</span>
<span class="sd">        return a Plotly scatter object to be combined with other</span>
<span class="sd">        data. If a layout is given, then the data will be plot</span>
<span class="sd">        up directly.</span>

<span class="sd">        Input arguments:</span>
<span class="sd">        dataframe - pandas dataframe object</span>
<span class="sd">        col - str specifying the column used to plot</span>
<span class="sd">        layout - optional argument; if specified a plotly plot will be</span>
<span class="sd">        produced.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># If no legend name is provided, use the column</span>
    <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">col</span>
    <span class="c1"># Generate the scatter plot</span>
    <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;#1c9099&quot;</span>
    <span class="n">trace</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">dataframe</span><span class="p">[</span><span class="s2">&quot;Frequency&quot;</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">dataframe</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="n">color</span><span class="p">}</span>
    <span class="p">)</span>
    <span class="c1"># If a layout is supplied, plot the figure</span>
    <span class="k">if</span> <span class="n">layout</span><span class="p">:</span>
        <span class="n">figure</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="n">trace</span><span class="p">],</span> <span class="n">layout</span><span class="o">=</span><span class="n">layout</span><span class="p">)</span>
        <span class="n">iplot</span><span class="p">(</span><span class="n">figure</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">trace</span></div>


<div class="viewcode-block" id="define_layout"><a class="viewcode-back" href="../../pyspectools.html#pyspectools.figurefactory.define_layout">[docs]</a><span class="k">def</span> <span class="nf">define_layout</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Function for generating a layout for plotly.</span>
<span class="sd">        Some degree of customization is provided, but generally sticking</span>
<span class="sd">        with not having to fuss around with plots.</span>

<span class="sd">        Input arguments:</span>
<span class="sd">        x/ylabel - str for what the x and y labels are to be</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">layout</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span>
        <span class="n">xaxis</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="n">xlabel</span><span class="p">,</span> <span class="s2">&quot;tickformat&quot;</span><span class="p">:</span> <span class="s2">&quot;.,&quot;</span><span class="p">},</span>
        <span class="n">yaxis</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="n">ylabel</span><span class="p">},</span>
        <span class="n">autosize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">height</span><span class="o">=</span><span class="mf">650.0</span><span class="p">,</span>
        <span class="n">width</span><span class="o">=</span><span class="mf">850.0</span><span class="p">,</span>
        <span class="n">paper_bgcolor</span><span class="o">=</span><span class="s2">&quot;#ffffff&quot;</span><span class="p">,</span>
        <span class="n">plot_bgcolor</span><span class="o">=</span><span class="s2">&quot;#ffffff&quot;</span><span class="p">,</span>
        <span class="n">font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">family</span><span class="o">=</span><span class="s2">&quot;Roboto&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#000000&quot;</span><span class="p">),</span>
        <span class="n">annotations</span><span class="o">=</span><span class="nb">list</span><span class="p">(),</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">layout</span></div>


<div class="viewcode-block" id="save_plot"><a class="viewcode-back" href="../../pyspectools.html#pyspectools.figurefactory.save_plot">[docs]</a><span class="k">def</span> <span class="nf">save_plot</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">js</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method for exporting a plotly figure with interactivity.</span>
<span class="sd">        This method does inject the plotly.js code by default, and so will</span>
<span class="sd">        result in relatively large files. Use `save_html` instead.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">plot</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span> <span class="n">show_link</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">auto_open</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">include_plotlyjs</span><span class="o">=</span><span class="n">js</span><span class="p">)</span></div>


<div class="viewcode-block" id="cfa_cmap"><a class="viewcode-back" href="../../pyspectools.html#pyspectools.figurefactory.cfa_cmap">[docs]</a><span class="k">def</span> <span class="nf">cfa_cmap</span><span class="p">(</span><span class="n">nsteps</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate a Matplotlib colormap with the CfA branding colors. Performs a linear interpolation from the CfA red to</span>
<span class="sd">    the so-called CfA violet.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    nsteps - int</span>
<span class="sd">        Number of steps to take in the interpolation; i.e. number of colors to return</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    LinearSegementedColormap instance</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">141</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">52</span><span class="p">),</span> <span class="p">(</span><span class="mi">43</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">117</span><span class="p">)]</span>
    <span class="n">cm</span> <span class="o">=</span> <span class="n">cl</span><span class="o">.</span><span class="n">LinearSegmentedColormap</span><span class="p">(</span><span class="s2">&quot;cfa&quot;</span><span class="p">,</span> <span class="n">colors</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="n">nsteps</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">cm</span></div>


<div class="viewcode-block" id="pandas_bokeh_table"><a class="viewcode-back" href="../../pyspectools.html#pyspectools.figurefactory.pandas_bokeh_table">[docs]</a><span class="k">def</span> <span class="nf">pandas_bokeh_table</span><span class="p">(</span><span class="n">dataframe</span><span class="p">,</span> <span class="n">html</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert a Pandas DataFrame to a Bokeh DataTable object.</span>
<span class="sd">    Columns will be automatically generated based on the DataFrame keys.</span>
<span class="sd">    The `html` flag can be used to specify whether or not an HTML representation is returned.</span>

<span class="sd">    Additional kwargs are passed into the `file_html` function, and is only used when `html`</span>
<span class="sd">    is True.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    dataframe : pandas dataframe</span>
<span class="sd">        Pandas DataFrame to convert into a DataTable object</span>
<span class="sd">    html : bool, optional</span>
<span class="sd">        If True, function will return a string of the HTML code for embedding</span>
<span class="sd">    kwargs</span>
<span class="sd">        Additional kwargs are passed into the HTML conversion</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    DataTable object if html is False, otherwise str</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">source</span> <span class="o">=</span> <span class="n">ColumnDataSource</span><span class="p">(</span><span class="n">dataframe</span><span class="p">)</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">TableColumn</span><span class="p">(</span><span class="n">field</span><span class="o">=</span><span class="n">key</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">key</span><span class="o">.</span><span class="n">capitalize</span><span class="p">())</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">dataframe</span><span class="p">]</span>
    <span class="n">table</span> <span class="o">=</span> <span class="n">DataTable</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="n">source</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">html</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">file_html</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">CDN</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">table</span></div>


<div class="viewcode-block" id="init_bokeh_figure"><a class="viewcode-back" href="../../pyspectools.html#pyspectools.figurefactory.init_bokeh_figure">[docs]</a><span class="k">def</span> <span class="nf">init_bokeh_figure</span><span class="p">(</span><span class="n">yml_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize a Bokeh Figure object. This code is fairly low level, and is</span>
<span class="sd">    used simply as a matter of convenience for supplying a default theme even</span>
<span class="sd">    without the user explicitly providing one.</span>

<span class="sd">    Kwargs are passed into the creation of the figure, and so further</span>
<span class="sd">    customization like title, axis limits, etc. should be supplied this way.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    yml_path : str or None, optional</span>
<span class="sd">        If None, uses the PySpecTools default bokeh styling. If a str is</span>
<span class="sd">        provided then it should correspond to the filepath to a YAML file.</span>
<span class="sd">    kwargs</span>
<span class="sd">        Kwargs are passed into the creation of the Figure object</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Bokeh Figure object</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">yml_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Use the default stylesheet</span>
        <span class="n">yml_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;/.pyspectools/bokeh.yml&quot;</span>
    <span class="c1"># Set the document theme</span>
    <span class="n">doc</span> <span class="o">=</span> <span class="n">curdoc</span><span class="p">()</span>
    <span class="n">doc</span><span class="o">.</span><span class="n">theme</span> <span class="o">=</span> <span class="n">Theme</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">yml_path</span><span class="p">)</span>
    <span class="n">default_params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;tools&quot;</span><span class="p">:</span> <span class="s2">&quot;crosshair,pan,wheel_zoom,box_zoom,reset,box_select,&quot;</span> <span class="s2">&quot;lasso_select&quot;</span><span class="p">,</span>
        <span class="s2">&quot;outline_line_color&quot;</span><span class="p">:</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span>
        <span class="s2">&quot;output_backend&quot;</span><span class="p">:</span> <span class="s2">&quot;webgl&quot;</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">default_params</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">figure</span><span class="p">(</span><span class="o">**</span><span class="n">default_params</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fig</span></div>
</pre></div>

    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 20172020, Kelvin Lee.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.1.1.<br/>
    </p>
  </div>
</footer>
  </body>
</html>